[[分类汇总]]

在Excel中，如果你想要自动填充列中的空白单元格，使它们的值等于上面最近的非空白单元格，你可以使用以下方法：

[[多列自动填充空值宏]]
### 方法1：使用Excel的“填充”功能

1. 选择包含空白单元格的列。
2. 转到“首页”选项卡。
3. 在“编辑”组中点击“查找和选择”按钮，然后选择“定位条件”。
4. 在定位条件对话框中，选择“空值”然后点击“确定”，这会选择所有的空单元格。
5. 输入`=`, 然后按上箭头键选择上面的单元格。
6. 然后按`Ctrl` + `Enter`，这会将所有选中的空单元格填充为上方相邻单元格的公式。

注意：这样会使用公式填充单元格，如果你需要它们为实际的值，你可以按下`Ctrl` + `C`来复制这些单元格，然后使用“粘贴为数值”选项来覆盖它们。

### 方法2：使用Excel的动态数组公式（仅适用于支持动态数组的Excel版本）

如果你的Excel版本支持动态数组（Excel 365或Excel 2019后期版本），你可以使用以下公式：



=IF(A2="",@A1,A2)

这里假定数据开始于A2。将这个公式输入到B2中，如果A2为空，则B2将显示A1的值，否则显示A2的值。由于是动态数组公式，它会自动填充到下面的单元格中。

### 方法3：使用VBA宏

以下是一个简单的VBA宏示例，该宏会遍历选定的列（只有一个列），将空白单元格替换为上方相邻非空白单元格的值。

```vba
Sub FillBlanks()
    Dim rng As Range
    Dim cell As Range
    Set rng = Selection
    For Each cell In rng
        If cell.Value = "" Then
            cell.Value = cell.Offset(-1, 0).Value
        End If
    Next cell
End Sub
```

要使用此宏，请按照以下步骤操作：

1. 按`Alt` + `F11`打开VBA编辑器。
2. 选择“插入” -> “模块”，在打开的窗口中粘贴上述代码。
3. 关闭VBA编辑器，返回Excel。
4. 选择你的数据列（不包括标题）。
5. 按`Alt` + `F8`，在弹出的对话框中选择`FillBlanks`宏，然后点击“运行”。

运行宏后，所有选定列中的空白单元格都会被上面最近的非空单元格的值填充。在运行任何宏之前，记得先备份你的数据。